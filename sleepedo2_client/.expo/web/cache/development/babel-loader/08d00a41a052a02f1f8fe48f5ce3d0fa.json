{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Alden\\\\Documents\\\\Code\\\\javascript\\\\mobile\\\\sleepedo2main\\\\sleepedo2_client\\\\components\\\\chatbox.js\";\nimport React, { useState, useEffect, useContext, useCallback } from 'react';\nimport { SocketContext } from \"./socket\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { TouchableOpacityBase } from \"react-native-web/dist/index\";\nimport Icon from \"@expo/vector-icons/MaterialCommunityIcons\";\nimport IonIcon from \"@expo/vector-icons/Ionicons\";\nexport default function Chatbox(props) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      dismissOpen = _useState2[0],\n      setDismissOpen = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      dismissCount = _useState4[0],\n      setDismissCount = _useState4[1];\n\n  var _useState5 = useState(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      snoozeCount = _useState6[0],\n      setSnoozeCount = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      room = _useState8[0],\n      setRoom = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      alarmId = _useState10[0],\n      setAlarmId = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      disconnected = _useState12[0],\n      setDisconnected = _useState12[1];\n\n  var _useState13 = useState(true),\n      _useState14 = _slicedToArray(_useState13, 2),\n      modalOpen = _useState14[0],\n      setModalOpen = _useState14[1];\n\n  var socket = useContext(SocketContext);\n\n  var _useState15 = useState(''),\n      _useState16 = _slicedToArray(_useState15, 2),\n      text = _useState16[0],\n      setText = _useState16[1];\n\n  var _useState17 = useState(''),\n      _useState18 = _slicedToArray(_useState17, 2),\n      partner = _useState18[0],\n      setPartner = _useState18[1];\n\n  var _useState19 = useState(60),\n      _useState20 = _slicedToArray(_useState19, 2),\n      timeLeft = _useState20[0],\n      setTimeLeft = _useState20[1];\n\n  var getMessage = useCallback(function (message) {\n    console.log('received message: ', message);\n  }, []);\n  var triggered = useCallback(function (room, alarmId) {\n    console.log('joining room: ', room);\n    setRoom(room);\n    setAlarmId(alarmId);\n    setModalOpen(true);\n  }, []);\n  var resetStuff = useCallback(function () {\n    setModalOpen(false);\n    setDismissOpen(true);\n    setSnoozeCount(0);\n    setDismissCount(0);\n  }, []);\n  var disconnection = useCallback(function () {\n    setDisconnected(true);\n    setModalOpen(false);\n  }, []);\n  useEffect(function () {\n    socket.on('get-message', function (message) {\n      getMessage(message);\n    });\n    return function () {\n      socket.offAny();\n    };\n  }, [socket, getMessage]);\n\n  function back() {\n    props.navigation.navigate(\"Home\");\n  }\n\n  function dismiss() {\n    setDismissCount(dismissCount + 1);\n    socket.emit('send-dismiss', room, alarmId);\n    setDismissOpen(false);\n  }\n\n  function snooze() {\n    setSnoozeCount(snoozeCount + 1);\n    socket.emit('send-snooze', room, alarmId);\n    setDismissOpen(false);\n  }\n\n  var sendText = useCallback(function (e) {\n    e.preventDefault();\n    socket.emit('send-message', sessionStorage.getItem('username'), text, room);\n    addOutTexts(text);\n    setText('');\n  }, [socket, text]);\n\n  if (modalOpen) {\n    return React.createElement(View, {\n      style: styles.container,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }, React.createElement(View, {\n      style: styles.topbar,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }\n    }, React.createElement(TouchableOpacity, {\n      onPress: back,\n      style: styles.backButton,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 21\n      }\n    }, React.createElement(IonIcon, {\n      color: \"#e1e1e1\",\n      name: \"arrow-back-sharp\",\n      size: 25,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 25\n      }\n    })), React.createElement(Text, {\n      style: styles.topbarText,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 21\n      }\n    }, \"Chat - \", partner), React.createElement(Text, {\n      style: styles.countdown,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 21\n      }\n    }, \"00:\", timeLeft)), React.createElement(View, {\n      style: styles.messageContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 17\n      }\n    }, React.createElement(View, {\n      style: styles.messageOut,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 21\n      }\n    }, React.createElement(Text, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 25\n      }\n    }, \"hello there this is a message\"))), React.createElement(View, {\n      style: styles.bottomContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }\n    }, React.createElement(TouchableOpacity, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 21\n      }\n    }, React.createElement(IonIcon, {\n      style: {\n        marginLeft: 20\n      },\n      color: \"#e1e1e1\",\n      name: \"ios-gift-outline\",\n      size: 25,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 25\n      }\n    })), React.createElement(TextInput, {\n      style: styles.textInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 21\n      }\n    }), React.createElement(TouchableOpacity, {\n      style: styles.sendButton,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 21\n      }\n    }, React.createElement(Text, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 25\n      }\n    }, \"Send\"))));\n  } else return null;\n}\nvar styles = StyleSheet.create({\n  container: {\n    display: 'flex',\n    flex: 1,\n    flexGrow: 1,\n    width: '100%',\n    height: '100%',\n    backgroundColor: '#222'\n  },\n  topbar: {\n    width: '100%',\n    height: '10%',\n    backgroundColor: 'grey',\n    justifyContent: 'center',\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'flex-start',\n    alignItems: 'center'\n  },\n  backButton: {\n    marginLeft: 20\n  },\n  topbarText: {\n    marginLeft: 10,\n    fontSize: 20\n  },\n  countdown: {\n    marginLeft: 40,\n    fontSize: 16\n  },\n  messageContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'flex-end',\n    backgroundColor: '#282c34',\n    height: '78%',\n    maxHeight: '78%',\n    width: '100%',\n    overflow: 'visible'\n  },\n  messageOut: {\n    fontSize: 10,\n    padding: 20,\n    alignSelf: 'flex-end'\n  },\n  bottomContainer: {\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n    width: '100%',\n    height: '12%',\n    backgroundColor: 'grey'\n  },\n  textInput: {\n    width: '65%',\n    height: '80%',\n    backgroundColor: '#222',\n    borderTopLeftRadius: 10,\n    borderBottomLeftRadius: 10,\n    marginLeft: 20\n  },\n  sendButton: {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: 'white',\n    borderTopRightRadius: 10,\n    borderBottomRightRadius: 10,\n    width: '20%',\n    height: '80%'\n  }\n});","map":{"version":3,"sources":["C:/Users/Alden/Documents/Code/javascript/mobile/sleepedo2main/sleepedo2_client/components/chatbox.js"],"names":["React","useState","useEffect","useContext","useCallback","SocketContext","TouchableOpacityBase","Icon","IonIcon","Chatbox","props","dismissOpen","setDismissOpen","dismissCount","setDismissCount","snoozeCount","setSnoozeCount","room","setRoom","alarmId","setAlarmId","disconnected","setDisconnected","modalOpen","setModalOpen","socket","text","setText","partner","setPartner","timeLeft","setTimeLeft","getMessage","message","console","log","triggered","resetStuff","disconnection","on","offAny","back","navigation","navigate","dismiss","emit","snooze","sendText","e","preventDefault","sessionStorage","getItem","addOutTexts","styles","container","topbar","backButton","topbarText","countdown","messageContainer","messageOut","bottomContainer","marginLeft","textInput","sendButton","StyleSheet","create","display","flex","flexGrow","width","height","backgroundColor","justifyContent","flexDirection","alignItems","fontSize","maxHeight","overflow","padding","alignSelf","borderTopLeftRadius","borderBottomLeftRadius","borderTopRightRadius","borderBottomRightRadius"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext, useCallback } from 'react';\r\nimport { SocketContext } from './socket';\r\nimport { TouchableOpacity, StyleSheet, Text, TextInput, View, TouchableOpacityBase } from 'react-native';\r\nimport Icon from 'react-native-vector-icons/MaterialCommunityIcons';\r\nimport IonIcon from 'react-native-vector-icons/Ionicons';\r\n\r\n\r\n\r\nexport default function Chatbox(props) {\r\n\r\n    const [dismissOpen, setDismissOpen] = useState(false);\r\n    const [dismissCount, setDismissCount] = useState(0);\r\n    const [snoozeCount, setSnoozeCount] = useState(0);\r\n    const [room, setRoom] = useState('');\r\n    const [alarmId, setAlarmId] = useState('');\r\n    const [disconnected, setDisconnected] = useState(false);\r\n    const [modalOpen, setModalOpen] = useState(true);\r\n    const socket = useContext(SocketContext);\r\n    const [text, setText] = useState('');\r\n    const [partner, setPartner] = useState('');\r\n    const [timeLeft, setTimeLeft] = useState(60);\r\n\r\n    const getMessage = useCallback((message) => {\r\n        console.log('received message: ', message);\r\n\r\n    }, []);\r\n\r\n    const triggered = useCallback((room, alarmId) => {\r\n        console.log('joining room: ', room);\r\n        setRoom(room);\r\n        setAlarmId(alarmId);\r\n        setModalOpen(true);\r\n    }, []);\r\n\r\n    const resetStuff = useCallback(() => {\r\n        setModalOpen(false);\r\n        setDismissOpen(true);\r\n        setSnoozeCount(0);\r\n        setDismissCount(0);\r\n    }, []);\r\n\r\n    const disconnection = useCallback(() => {\r\n        setDisconnected(true);\r\n        setModalOpen(false);\r\n    }, [])\r\n\r\n\r\n    // function decrement() {\r\n    //     if (timeLeft > 0) setTimeLeft(timeLeft - 1);\r\n    // }\r\n    // setInterval(decrement, 1000);\r\n\r\n    useEffect(() => {\r\n\r\n        socket.on('get-message', (message) => {\r\n            getMessage(message);\r\n        });\r\n        return () => {\r\n            socket.offAny();\r\n        }\r\n    }, [socket, getMessage])\r\n\r\n    function back() {\r\n        props.navigation.navigate(\"Home\");\r\n    }\r\n\r\n    function dismiss() {\r\n        setDismissCount(dismissCount + 1);\r\n        socket.emit('send-dismiss', room, alarmId);\r\n        setDismissOpen(false);\r\n    }\r\n    function snooze() {\r\n        setSnoozeCount(snoozeCount + 1);\r\n        socket.emit('send-snooze', room, alarmId);   //tell other user that you hit snooze\r\n        setDismissOpen(false);\r\n    }\r\n\r\n    const sendText = useCallback((e) => {\r\n        e.preventDefault();\r\n        socket.emit('send-message', sessionStorage.getItem('username'), text, room);   //when modal is closed this function is called\r\n        addOutTexts(text);\r\n        setText('');\r\n\r\n    }, [socket, text]);\r\n\r\n    // let dismissButton;\r\n    // if (dismissOpen) {\r\n    //     dismissButton =\r\n    //         <View style={{ display: 'flex', flexDirection: 'row', justifyContent: 'center', position: 'relative', zIndex: 4 }}>\r\n    //             <TouchableOpacity onPress={snooze}>\r\n    //                 <Text>Vote Snooze {`(${snoozeCount}/2)`}</Text>\r\n    //             </TouchableOpacity>\r\n    //             <TouchableOpacity onPress={dismiss}>\r\n    //                 <Text>Dismiss {`(${dismissCount}/2)`}</Text>\r\n    //             </TouchableOpacity>\r\n    //         </View>\r\n    // }\r\n\r\n    if (modalOpen) {\r\n        return (\r\n            <View style={styles.container}>\r\n                <View style={styles.topbar}>\r\n                    <TouchableOpacity onPress={back} style={styles.backButton} >\r\n                        <IonIcon color=\"#e1e1e1\" name=\"arrow-back-sharp\" size={25} />\r\n                    </TouchableOpacity>\r\n                    <Text style={styles.topbarText}>Chat - {partner}</Text>\r\n                    <Text style={styles.countdown}>00:{timeLeft}</Text>\r\n                </View>\r\n                <View style={styles.messageContainer}>\r\n                    <View style={styles.messageOut}>\r\n                        <Text>hello there this is a message</Text>\r\n                    </View>\r\n                </View>\r\n                <View style={styles.bottomContainer}>\r\n                    <TouchableOpacity>\r\n                        <IonIcon style={{ marginLeft: 20 }} color=\"#e1e1e1\" name=\"ios-gift-outline\" size={25} />\r\n                    </TouchableOpacity>\r\n                    <TextInput style={styles.textInput} />\r\n                    <TouchableOpacity style={styles.sendButton}>\r\n                        <Text>Send</Text>\r\n                    </TouchableOpacity>\r\n                </View>\r\n            </View>\r\n        )\r\n    }\r\n    else return null;\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        display: 'flex',\r\n        flex: 1,\r\n        flexGrow: 1,\r\n        width: '100%',\r\n        height: '100%',\r\n        backgroundColor: '#222'\r\n    },\r\n    topbar: {\r\n        width: '100%',\r\n        height: '10%',\r\n        backgroundColor: 'grey',\r\n        justifyContent: 'center',\r\n        display: 'flex',\r\n        flexDirection: 'row',\r\n        justifyContent: 'flex-start',\r\n        alignItems: 'center'\r\n    },\r\n    backButton: {\r\n        marginLeft: 20\r\n    },\r\n    topbarText: {\r\n        marginLeft: 10,\r\n        fontSize: 20\r\n    },\r\n    countdown: {\r\n        marginLeft: 40,\r\n        fontSize: 16\r\n    },\r\n    messageContainer: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        justifyContent: 'flex-end',\r\n        backgroundColor: '#282c34',\r\n        height: '78%',\r\n        maxHeight: '78%',\r\n        width: '100%',\r\n        overflow: 'visible',\r\n    },\r\n    messageOut: {\r\n        fontSize: 10,\r\n        padding: 20,\r\n        alignSelf: 'flex-end',\r\n    },\r\n    bottomContainer: {\r\n        display: 'flex',\r\n        flexDirection: 'row',\r\n        alignItems: 'center',\r\n        width: '100%',\r\n        height: '12%',\r\n        backgroundColor: 'grey'\r\n    },\r\n    textInput: {\r\n        width: '65%',\r\n        height: '80%',\r\n        backgroundColor: '#222',\r\n        borderTopLeftRadius: 10,\r\n        borderBottomLeftRadius: 10,\r\n        marginLeft: 20\r\n    },\r\n    sendButton: {\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        backgroundColor: 'white',\r\n        borderTopRightRadius: 10,\r\n        borderBottomRightRadius: 10,\r\n        width: '20%',\r\n        height: '80%'\r\n    }\r\n})"]},"metadata":{},"sourceType":"module"}