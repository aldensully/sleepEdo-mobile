{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Alden\\\\Documents\\\\Code\\\\javascript\\\\mobile\\\\sleepedo2main\\\\sleepedo2_client\\\\components\\\\chatbox.js\";\nimport React, { useState, useEffect } from 'react';\nimport { Paper, Button, Typography, makeStyles } from '@material-ui/core';\nimport { SocketContext } from \"./socket\";\nvar useStyles = makeStyles({\n  paper: {\n    width: '70%',\n    maxWidth: '70%',\n    height: '10vh',\n    backgroundColor: 'inherit',\n    marginTop: '1vh',\n    position: 'relative',\n    borderRadius: '10px',\n    boxShadow: '0 0 20px 3px #16181c'\n  },\n  topBar: {\n    width: '100%',\n    height: '1vh',\n    backgroundColor: '#2b2f36',\n    borderRadius: 0,\n    display: 'flex',\n    borderTopLeftRadius: '10px',\n    borderTopRightRadius: '10px',\n    borderBottom: '0.5px solid #212121'\n  },\n  topBarText: {\n    fontSize: 10,\n    padding: 2,\n    color: '#bdbdbd'\n  },\n  chatbox: {\n    backgroundColor: '#282c34',\n    height: '100%',\n    maxHeight: '5vh',\n    width: '100%',\n    overflow: 'auto',\n    display: 'flex',\n    justifyContent: 'flex-end',\n    flexDirection: 'column'\n  },\n  messageinbox: {\n    fontFamily: 'sans-serif',\n    padding: '2px',\n    width: '60%',\n    borderRadius: '5px',\n    wordWrap: 'break-word',\n    height: 'fit-content',\n    backgroundColor: '#363a42',\n    color: '#f3f3f3',\n    marginTop: '5px',\n    alignSelf: 'flex-start',\n    boxShadow: '0 0 20px 1px #1f2229'\n  },\n  messageoutbox: {\n    width: '60%',\n    borderRadius: '5px',\n    wordWrap: 'break-word',\n    height: 'fit-content',\n    backgroundColor: '#3e4c59',\n    color: '#f3f3f3',\n    marginTop: '20px',\n    alignSelf: 'flex-end',\n    boxShadow: '0 0 20px 1px #1f2229'\n  },\n  messagetext: {\n    color: '#bdbdbd'\n  }\n});\nexport default function Chatbox(props) {\n  var classes = useStyles();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      dismissOpen = _useState2[0],\n      setDismissOpen = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      dismissCount = _useState4[0],\n      setDismissCount = _useState4[1];\n\n  var _useState5 = useState(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      snoozeCount = _useState6[0],\n      setSnoozeCount = _useState6[1];\n\n  var _useState7 = useState(''),\n      _useState8 = _slicedToArray(_useState7, 2),\n      room = _useState8[0],\n      setRoom = _useState8[1];\n\n  var _useState9 = useState(''),\n      _useState10 = _slicedToArray(_useState9, 2),\n      alarmId = _useState10[0],\n      setAlarmId = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      disconnected = _useState12[0],\n      setDisconnected = _useState12[1];\n\n  var _useState13 = useState(true),\n      _useState14 = _slicedToArray(_useState13, 2),\n      modalOpen = _useState14[0],\n      setModalOpen = _useState14[1];\n\n  var socket = useContext(SocketContext);\n\n  var _useState15 = useState(''),\n      _useState16 = _slicedToArray(_useState15, 2),\n      text = _useState16[0],\n      setText = _useState16[1];\n\n  var getMessage = useCallback(function (message) {\n    console.log('received message: ', message);\n  }, []);\n  var triggered = useCallback(function (room, alarmId) {\n    console.log('joining room: ', room);\n    setRoom(room);\n    setAlarmId(alarmId);\n    setModalOpen(true);\n  }, []);\n  var resetStuff = useCallback(function () {\n    setModalOpen(false);\n    setDismissOpen(true);\n    setSnoozeCount(0);\n    setDismissCount(0);\n  }, []);\n  var disconnection = useCallback(function () {\n    setDisconnected(true);\n    setModalOpen(false);\n  }, []);\n  useEffect(function () {\n    socket.on('triggered', function (room, alarmId) {\n      triggered(room, alarmId);\n    });\n    socket.on('get-message', function (message) {\n      getMessage(message);\n    });\n    socket.on('get-snooze', function () {\n      setSnoozeCount(snoozeCount + 1);\n    });\n    socket.on('get-dismiss', function () {\n      setDismissCount(dismissCount + 1);\n    });\n    socket.on('snooze-begin', function () {\n      console.log('snooze for 9 minutes!');\n      resetStuff();\n    });\n    socket.on('dismiss-begin', function () {\n      console.log('both users have dismissed alarm!');\n    });\n    socket.on('room-disconnect', function () {\n      console.log('time up, disconnected from room');\n      resetStuff();\n      disconnection();\n    });\n    return function () {\n      socket.offAny();\n    };\n  }, [socket, getMessage, resetStuff, disconnection, triggered]);\n\n  function dismiss() {\n    setDismissCount(dismissCount + 1);\n    socket.emit('send-dismiss', room, alarmId);\n    setDismissOpen(false);\n  }\n\n  function snooze() {\n    setSnoozeCount(snoozeCount + 1);\n    socket.emit('send-snooze', room, alarmId);\n    setDismissOpen(false);\n  }\n\n  var sendText = useCallback(function (e) {\n    e.preventDefault();\n    socket.emit('send-message', sessionStorage.getItem('username'), text, room);\n    addOutTexts(text);\n    setText('');\n  }, [socket, text]);\n  var dismissButton;\n\n  if (dismissOpen) {\n    dismissButton = React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'center',\n        position: 'relative',\n        zIndex: 4\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 13\n      }\n    }, React.createElement(Button, {\n      variant: \"outlined\",\n      onClick: function onClick() {\n        return snooze();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }\n    }, React.createElement(Typography, {\n      variant: \"h6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 21\n      }\n    }, \"Vote Snooze \", \"(\" + snoozeCount + \"/2)\")), React.createElement(Button, {\n      variant: \"outlined\",\n      onClick: function onClick() {\n        return dismiss();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 17\n      }\n    }, React.createElement(Typography, {\n      variant: \"h6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 21\n      }\n    }, \"Dismiss \", \"(\" + dismissCount + \"/2)\")));\n  }\n\n  if (modalOpen) {\n    return React.createElement(\"div\", {\n      className: classes.paper,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 13\n      }\n    }, React.createElement(Paper, {\n      className: classes.topBar,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 17\n      }\n    }, React.createElement(Typography, {\n      className: classes.topBarText,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 21\n      }\n    }, \"Chat - Rainbow69\"), dismissButton), React.createElement(\"div\", {\n      id: \"chatbox\",\n      className: classes.chatbox,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 17\n      }\n    }), React.createElement(\"form\", {\n      className: classes.bottomContainer,\n      onSubmit: sendText,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 17\n      }\n    }, React.createElement(\"input\", {\n      value: text,\n      placeholder: \"Write a message..\",\n      autoFocus: true,\n      className: classes.textfield,\n      onChange: function onChange(e) {\n        return setText(e.target.value);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 21\n      }\n    }), React.createElement(\"button\", {\n      type: \"submit\",\n      className: classes.sendButton,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 21\n      }\n    }, \"Send\")));\n  } else return null;\n}","map":{"version":3,"sources":["C:/Users/Alden/Documents/Code/javascript/mobile/sleepedo2main/sleepedo2_client/components/chatbox.js"],"names":["React","useState","useEffect","Paper","Button","Typography","makeStyles","SocketContext","useStyles","paper","width","maxWidth","height","backgroundColor","marginTop","position","borderRadius","boxShadow","topBar","display","borderTopLeftRadius","borderTopRightRadius","borderBottom","topBarText","fontSize","padding","color","chatbox","maxHeight","overflow","justifyContent","flexDirection","messageinbox","fontFamily","wordWrap","alignSelf","messageoutbox","messagetext","Chatbox","props","classes","dismissOpen","setDismissOpen","dismissCount","setDismissCount","snoozeCount","setSnoozeCount","room","setRoom","alarmId","setAlarmId","disconnected","setDisconnected","modalOpen","setModalOpen","socket","useContext","text","setText","getMessage","useCallback","message","console","log","triggered","resetStuff","disconnection","on","offAny","dismiss","emit","snooze","sendText","e","preventDefault","sessionStorage","getItem","addOutTexts","dismissButton","zIndex","bottomContainer","textfield","target","value","sendButton"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Paper, Button, Typography, makeStyles } from '@material-ui/core';\r\nimport { SocketContext } from './socket';\r\n\r\n\r\nconst useStyles = makeStyles({\r\n    paper: {\r\n        width: '70%',\r\n        maxWidth: '70%',\r\n        height: '10vh',\r\n        backgroundColor: 'inherit',\r\n        marginTop: '1vh',\r\n        position: 'relative',\r\n        borderRadius: '10px',\r\n        boxShadow: '0 0 20px 3px #16181c',\r\n    },\r\n    topBar: {\r\n        width: '100%',\r\n        height: '1vh',\r\n        backgroundColor: '#2b2f36',\r\n        borderRadius: 0,\r\n        display: 'flex',\r\n        borderTopLeftRadius: '10px',\r\n        borderTopRightRadius: '10px',\r\n        borderBottom: '0.5px solid #212121',\r\n\r\n    },\r\n    topBarText: {\r\n        fontSize: 10,\r\n        padding: 2,\r\n        color: '#bdbdbd'\r\n    },\r\n    chatbox: {\r\n        backgroundColor: '#282c34',\r\n        height: '100%',\r\n        maxHeight: '5vh',\r\n        width: '100%',\r\n        overflow: 'auto',\r\n        display: 'flex',\r\n        justifyContent: 'flex-end',\r\n        flexDirection: 'column',\r\n    },\r\n    messageinbox: {\r\n        fontFamily: 'sans-serif',\r\n        padding: '2px',\r\n        width: '60%',\r\n        borderRadius: '5px',\r\n        wordWrap: 'break-word',\r\n        height: 'fit-content',\r\n        backgroundColor: '#363a42',\r\n        color: '#f3f3f3',\r\n        marginTop: '5px',\r\n        alignSelf: 'flex-start',\r\n        boxShadow: '0 0 20px 1px #1f2229'\r\n\r\n    },\r\n    messageoutbox: {\r\n        width: '60%',\r\n        borderRadius: '5px',\r\n        wordWrap: 'break-word',\r\n        height: 'fit-content',\r\n        backgroundColor: '#3e4c59',\r\n        color: '#f3f3f3',\r\n        marginTop: '20px',\r\n        alignSelf: 'flex-end',\r\n        boxShadow: '0 0 20px 1px #1f2229'\r\n\r\n    },\r\n    messagetext: {\r\n        color: '#bdbdbd',\r\n    },\r\n})\r\n\r\nexport default function Chatbox(props) {\r\n\r\n    const classes = useStyles();\r\n    const [dismissOpen, setDismissOpen] = useState(false);\r\n    const [dismissCount, setDismissCount] = useState(0);\r\n    const [snoozeCount, setSnoozeCount] = useState(0);\r\n    const [room, setRoom] = useState('');\r\n    const [alarmId, setAlarmId] = useState('');\r\n    const [disconnected, setDisconnected] = useState(false);\r\n    const [modalOpen, setModalOpen] = useState(true);\r\n    const socket = useContext(SocketContext);\r\n    const [text, setText] = useState('');\r\n\r\n\r\n    const getMessage = useCallback((message) => {\r\n        console.log('received message: ', message);\r\n\r\n    }, []);\r\n\r\n    const triggered = useCallback((room, alarmId) => {\r\n        console.log('joining room: ', room);\r\n        setRoom(room);\r\n        setAlarmId(alarmId);\r\n        setModalOpen(true);\r\n    }, []);\r\n\r\n    const resetStuff = useCallback(() => {\r\n        setModalOpen(false);\r\n        setDismissOpen(true);\r\n        setSnoozeCount(0);\r\n        setDismissCount(0);\r\n    }, []);\r\n\r\n    const disconnection = useCallback(() => {\r\n        setDisconnected(true);\r\n        setModalOpen(false);\r\n    }, [])\r\n\r\n\r\n    useEffect(() => {\r\n\r\n        socket.on('triggered', (room, alarmId) => {\r\n            triggered(room, alarmId);\r\n        });\r\n        socket.on('get-message', (message) => {\r\n            getMessage(message);\r\n        });\r\n        socket.on('get-snooze', () => {\r\n            setSnoozeCount(snoozeCount + 1);  //other user hit snooze\r\n        })\r\n        socket.on('get-dismiss', () => {\r\n            setDismissCount(dismissCount + 1); //other user hit dismiss\r\n        })\r\n        socket.on('snooze-begin', () => {\r\n            console.log('snooze for 9 minutes!');\r\n            resetStuff();\r\n        })\r\n        socket.on('dismiss-begin', () => {\r\n            console.log('both users have dismissed alarm!');\r\n        })\r\n        socket.on('room-disconnect', () => {\r\n            console.log('time up, disconnected from room');\r\n            resetStuff();\r\n            disconnection();\r\n        })\r\n        return () => {\r\n            socket.offAny();\r\n        }\r\n    }, [socket, getMessage, resetStuff, disconnection, triggered])\r\n\r\n\r\n\r\n    function dismiss() {\r\n        setDismissCount(dismissCount + 1);\r\n        socket.emit('send-dismiss', room, alarmId);\r\n        setDismissOpen(false);\r\n    }\r\n    function snooze() {\r\n        setSnoozeCount(snoozeCount + 1);\r\n        socket.emit('send-snooze', room, alarmId);   //tell other user that you hit snooze\r\n        setDismissOpen(false);\r\n    }\r\n\r\n    const sendText = useCallback((e) => {\r\n        e.preventDefault();\r\n        socket.emit('send-message', sessionStorage.getItem('username'), text, room);   //when modal is closed this function is called\r\n        addOutTexts(text);\r\n        setText('');\r\n\r\n    }, [socket, text]);\r\n\r\n    let dismissButton;\r\n    if (dismissOpen) {\r\n        dismissButton =\r\n            <div style={{ display: 'flex', flexDirection: 'row', justifyContent: 'center', position: 'relative', zIndex: 4 }}>\r\n                <Button variant='outlined' onClick={() => snooze()}>\r\n                    <Typography variant='h6'>Vote Snooze {`(${snoozeCount}/2)`}</Typography>\r\n                </Button>\r\n                <Button variant='outlined' onClick={() => dismiss()}>\r\n                    <Typography variant='h6'>Dismiss {`(${dismissCount}/2)`}</Typography>\r\n                </Button>\r\n            </div>\r\n    }\r\n\r\n    if (modalOpen) {\r\n        return (\r\n            <div className={classes.paper}>\r\n                <Paper className={classes.topBar}>\r\n                    <Typography className={classes.topBarText}>Chat - Rainbow69</Typography>\r\n                    {dismissButton}\r\n                </Paper>\r\n                <div id='chatbox' className={classes.chatbox}>\r\n                </div>\r\n\r\n                <form className={classes.bottomContainer} onSubmit={sendText}>\r\n                    <input value={text} placeholder='Write a message..' autoFocus className={classes.textfield} onChange={(e) => setText(e.target.value)}></input>\r\n                    <button type=\"submit\" className={classes.sendButton}>Send</button>\r\n                </form>\r\n\r\n            </div>\r\n        )\r\n    }\r\n    else return null;\r\n}"]},"metadata":{},"sourceType":"module"}